#!/bin/sh

show_usage () {
cat <<USAGE_END
Usage:
    $0 -s N [-c N|-k] [-m N] ["cmd" | -p N]
    $0 -h
USAGE_END
}

opt_s="2.5" # high load
opt_c="1.5" # low load
opt_k=0     # kill
opt_m=30    # monitor this often
opt_p=""    # other pid

while getopts 's:c:km:p:h' opt; do
    case $opt in
        s)  opt_s="$OPTARG" ;;
        c)  opt_c="$OPTARG" ;;
        k)  opt_k=1     ;;
        m)  opt_m="$OPTARG" ;;
        p)  opt_p="$OPTARG" ;;
        h)  usage; exit 0   ;;
        *)  usage; exit 1   ;;
    esac
done
shift $(( OPTIND - 1 ))

cmd="$1"

if [[ -z $cmd && -z $opt_p ]]; then
    echo 'Expected "cmd" or "-p N"'
    exit 1
elif [[ -z $opt_p ]]; then
    $cmd & cmd_pid=$!
else
    cmd_pid="$opt_p"
fi

while true; do
    sleep
done
